sources:
    - name: raw
      description: "Raw data source"
      schema: raw
      tables:
        - name: raw_orders
          description: "Raw order data"


models:
    - name: stg_orders
      description: "Staging view for order data"
      schema: stg
      columns:
        - name: order_id
          description: "Unique identifier for order"
          tests:
            - unique
            - not_null
        - name: customer_id
          description: "Unique identifier for the customer"
          tests:
            - relationships:
                arguments:
                  to: ref('stg_customer')
                  field: customer_id
        - name: ordered_at
          description: "Timestamp when the order was placed"
          tests:
            - not_null
      tests:
        - expression_is_true:
            arguments:
              expression: "order_total - tax_paid = subtotal"